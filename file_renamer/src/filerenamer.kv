#:kivy 2.0.0

# Set variables
#:set fs '16dp'

[FileListEntry@FloatLayout+TreeViewNode]:
    locked: False
    entries: []
    path: ctx.path
    # FIXME: is_selected is actually a read_only treeview property. In this
    # case, however, we're doing this because treeview only has single-selection
    # hardcoded in it. The fix to this would be to update treeview to allow
    # multiple selection.
    is_selected: self.path in ctx.controller().selection

    orientation: 'horizontal'
    size_hint_y: None
    height: '50dp' if dp(1) > 1 else '25dp'  # height must be big enough to hold font sized below
    # Don't allow expansion of the ../ node
    is_leaf: not ctx.isdir or ctx.name.endswith('..' + ctx.sep) or self.locked
    on_touch_down: self.collide_point(*args[1].pos) and ctx.controller().entry_touched(self, args[1])
    on_touch_up: self.collide_point(*args[1].pos) and ctx.controller().entry_released(self, args[1])
    BoxLayout:
        pos: root.pos
        size_hint_x: None
        width: root.width
        Label:
            id: filename
            font_size: fs  # adjust this font size
            size_hint_x: None
            width: root.width - sz.width  # this allows filename Label to fill width less size Label
            text_size: self.width, None
            halign: 'left'
            shorten: True
            text: ctx.name
        Label:
            id: sz
            font_size: fs  # adjust this font size
            #text_size: self.width, None
            size_hint_x: None
            width: self.texture_size[0] + dp(18)  # this makes the size Label to minimum width
            text: '{}'.format(ctx.get_nice_size())
